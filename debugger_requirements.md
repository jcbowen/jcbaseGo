# 调试器组件需求文档

## 项目背景
在使用Gin框架时，默认的日志输出存在以下问题：
- 日志信息过于冗长，包含大量不必要的信息
- 高并发场景下多个请求的日志混杂在一起，难以区分
- 缺乏结构化的日志存储和查询功能
- 对运维和调试造成较大负担

## 功能需求

### 1. 基础功能
- 封装为独立的调试器组件，支持在Gin项目中引用
- 支持多种存储方式：文件、内存、数据库
- 记录完整的请求和响应信息
- 提供灵活的配置选项，支持采样率、跳过路径、最大记录数等配置

### 2. 日志记录内容
- **请求数据**：请求方法、URL、请求体、查询参数
- **请求头**：完整的HTTP请求头信息
- **响应头**：完整的HTTP响应头信息
- **会话数据**：用户会话信息（如适用）
- **时间信息**：请求开始时间、响应时间、处理耗时
- **状态信息**：HTTP状态码、错误信息
- **请求ID**：用于请求追踪的唯一标识

### 3. 日志记录功能
- **日志级别支持**：支持Debug、Info、Warn、Error四个级别的日志记录
- **Logger接口**：提供完整的Logger接口，支持WithFields方法创建带字段的日志记录器
- **控制器集成**：在控制器中可以通过Logger.Error、Logger.Info、Logger.Debug等方法记录结构化日志
- **上下文集成**：支持从Gin上下文中获取Logger实例，自动携带请求上下文信息
- **自定义Logger**：支持传入自定义Logger实现

### 4. 日志管理功能
- **列表查看**：分页显示所有调试日志，支持按时间、状态码等排序
- **搜索功能**：支持按关键词搜索日志内容，包括请求URL、响应体、错误信息等
- **过滤功能**：支持按时间范围、请求路径、状态码、HTTP方法等条件过滤
- **详情查看**：显示单条日志的完整详细信息，包括请求头、响应头、请求体、响应体等
- **统计信息**：提供请求统计、方法分布、状态码分布等统计信息

### 5. 存储支持
- **文件存储**：将日志保存到本地文件系统，支持最大记录数限制
- **内存存储**：将日志保存在内存中，适合开发环境，支持LRU淘汰策略
- **数据库存储**：预留数据库存储接口，支持持久化存储
- **自定义存储**：支持传入自定义存储实现

### 6. Web界面功能
- **Web控制台**：提供完整的Web界面用于查看和管理调试日志
- **API接口**：提供RESTful API接口，支持JSON格式数据返回
- **模板渲染**：使用Go模板引擎渲染HTML页面
- **响应式设计**：适配不同屏幕尺寸的响应式界面

## 技术实现要点
- 使用Gin中间件拦截请求，捕获完整的请求和响应信息
- 设计灵活的存储接口，支持多种存储方式，支持分页查询和搜索
- 提供完整的Logger接口，支持结构化日志记录和字段传递
- 实现Web控制器，提供HTML页面和API接口两种访问方式
- 支持采样率配置，避免高并发场景下的性能问题
- 实现请求过滤机制，支持跳过特定路径和方法
- 提供统计信息功能，便于性能分析和问题排查

## 开发计划
1. ✅ 创建基础结构和配置系统
2. ✅ 实现文件存储和内存存储
3. ✅ 开发Gin中间件和请求拦截功能
4. ✅ 实现Logger接口和结构化日志记录
5. ✅ 开发Web控制器和查询管理功能
6. ✅ 实现搜索、过滤和统计功能
7. ✅ 编写完整的测试用例和示例代码
8. ✅ 完善文档和使用说明

## 预期效果
- 提供完整的结构化调试日志记录系统
- 支持灵活的日志查询、搜索和分析功能
- 提供友好的Web界面和API接口
- 显著改善开发和运维体验
- 提高问题排查效率和系统可观测性
- 支持高并发场景下的性能优化