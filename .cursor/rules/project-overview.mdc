
# jcbaseGo 项目架构指南

这是一个 Go 语言的基础工具包，提供了多个可复用的组件。

## 核心组件结构

### 主要目录说明
- `component/` - 核心组件目录
  - `attachment/` - 附件管理（支持本地、FTP、SFTP、OSS、COS等）
  - `helper/` - 工具函数集合，包含类型转换、字符串处理、结构体操作等
  - `mailer/` - 邮件发送组件
  - `orm/` - 数据库 ORM 抽象层，支持 MySQL 和 SQLite
  - `redis/` - Redis 缓存组件
  - `security/` - 安全相关功能（SM4/AES加密、密码处理等）
  - `trait/` - trait 模式实现，主要包含 CRUD 和控制器基础功能
  - `validator/` - 数据验证组件
  - `php/` - PHP 组件，允许在 Go 项目中调用 PHP 函数
  - `upgrade/` - 升级工具组件，提供项目代码自动升级功能
  - `tlsconfig/` - TLS 配置组件，提供安全的 TLS/SSL 配置管理
  - `command/` - 命令执行组件

### 关键文件
- [config.go](mdc:config.go) - 配置管理，支持 JSON、INI、命令行等多种配置源
- [type.go](mdc:type.go) - 全局类型定义
- [errcode/errcode.go](mdc:errcode/errcode.go) - 错误码定义

## 设计模式
- **组件化设计**：每个功能模块都是独立的组件
- **接口抽象**：使用接口定义规范，便于扩展和测试
- **Trait 模式**：通过 trait 提供可复用的行为
- **配置驱动**：支持多种配置源，便于不同环境部署

## 组件功能详解

### 附件管理组件 (attachment/)
- **多种存储支持**：本地、FTP、SFTP、阿里云 OSS、腾讯云 COS
- **文件类型管理**：图片、音频、视频、办公文件、压缩文件
- **上传方式**：支持表单上传、Base64 上传、字节数组上传
- **安全特性**：文件类型验证、大小限制、随机文件名

### Helper 工具包 (helper/)
- **类型转换**：智能类型转换，支持字符串、数字、布尔值互转
- **文件操作**：文件读写、目录管理、路径处理
- **字符串处理**：截取、替换、验证、随机生成
- **JSON 操作**：序列化、反序列化、结构体转换
- **SSH 工具**：远程连接、命令执行、文件传输
- **金额处理**：精确计算、格式化、中文大写转换
- **通用工具**：结构体默认值、Map 转换、哈希计算

### 安全组件 (security/)
- **SM4 加密**：国密算法，支持 CBC 和 GCM 模式
- **AES 加密**：标准加密算法，支持多种密钥长度
- **密码处理**：bcrypt 哈希、验证功能
- **安全工具**：随机数生成、安全字符串比较

### 数据库 ORM (orm/)
- **多数据库支持**：MySQL 和 SQLite
- **GORM 集成**：基于 GORM 的抽象层
- **连接池管理**：自动连接池优化
- **事务支持**：完整的事务操作

### CRUD Trait (trait/)
- **通用 CRUD**：创建、读取、更新、删除操作
- **软删除支持**：灵活的软删除配置
- **分页功能**：内置分页支持
- **钩子方法**：丰富的扩展点

### 邮件组件 (mailer/)
- **SMTP 支持**：标准 SMTP 协议
- **多种邮件类型**：文本、HTML、带附件邮件
- **安全连接**：TLS/SSL 支持
- **批量发送**：支持批量邮件发送

### 验证器组件 (validator/)
- **格式验证**：邮箱、手机号、身份证、URL、IP 地址
- **自定义验证**：支持扩展验证规则
- **批量验证**：支持批量数据验证
- **国际化**：多语言错误消息支持

### PHP 组件 (php/)
- **PHP 函数调用**：在 Go 中调用 PHP 函数
- **参数类型转换**：自动类型转换
- **交互功能**：控制台输入输出、确认操作
- **脚本管理**：内置 PHP 控制台脚本

### 升级工具 (upgrade/)
- **代码升级**：从 Git 仓库自动拉取最新代码
- **升级模式**：默认升级和暴力升级
- **分支管理**：支持不同分支升级
- **备份回滚**：升级前备份和失败回滚

### TLS 配置 (tlsconfig/)
- **安全配置**：TLS/SSL 安全配置管理
- **证书管理**：证书生成、验证、动态加载
- **双向认证**：mTLS 支持
- **安全最佳实践**：推荐的安全配置

### Redis 缓存 (redis/)
- **连接管理**：Redis 连接池管理
- **缓存操作**：键值存储、过期管理
- **数据类型**：支持各种 Redis 数据类型
- **性能优化**：连接复用和优化

## 项目特色

### 中文友好
- 所有组件都有详细的中文注释
- 错误信息使用中文描述
- 文档和示例全部中文化

### 配置驱动
- 统一的配置管理系统
- 支持多种配置源
- 环境变量和默认值支持

### 安全优先
- 内置安全组件和最佳实践
- 完善的输入验证和错误处理
- 安全的默认配置

### 易于扩展
- 接口抽象设计
- Trait 模式复用
- 插件化架构

## 开发规范
- 使用简体中文注释
- 代码结构清晰，避免多重嵌套
- 完善的错误处理机制
- 统一的接口设计风格
- 遵循 Go 语言最佳实践

## 使用场景
- **Web 应用开发**：提供完整的 Web 开发工具链
- **API 服务**：快速构建 RESTful API
- **数据处理**：文件处理、数据转换、批量操作
- **系统集成**：与第三方系统对接
- **工具开发**：命令行工具和脚本开发

- 代码结构清晰，避免多重嵌套
- 完善的错误处理机制
- 统一的接口设计风格
